<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<title>TransformedFigureTutorial</title>
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="TransformedFigureTutorial";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":9};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../diva/canvas/tutorial/TerminalTutorial.html" title="class in diva.canvas.tutorial"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../diva/canvas/tutorial/TransformedFigureTutorial.CloudFigure.html" title="class in diva.canvas.tutorial"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?diva/canvas/tutorial/TransformedFigureTutorial.html" target="_top">Frames</a></li>
<li><a href="TransformedFigureTutorial.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">diva.canvas.tutorial</div>
<h2 title="Class TransformedFigureTutorial" class="title">Class TransformedFigureTutorial</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>diva.canvas.tutorial.TransformedFigureTutorial</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">TransformedFigureTutorial</span>
extends java.lang.Object</pre>
<div class="block">This tutorial shows how to make custom figures that contain
 their own TransformContext.

 <img src="doc-files/TransformedFigureTutorial.gif" align="right" alt="Transformed Figure Tutorial">

 In the FigureTutorial class, we
 showed how to make a custom figure, and how to transform the
 various 2D shapes in the paint() method. Here, we will use
 an AffineTransform to do the same thing. This technique is
 a little more work to figure out how to do, but it's probably
 better if your figure has more than a couple of Shapes in it.

 <p> Transforms are a little tricky to get right, so the Diva
 Canvas provides a class, TransformContext, that you need to use
 to give a figure its own transform. Each instance of TransformContext
 contains a single AffineTransform, and a bunch of methods that
 deal with it.

 <p> The start of the CloudFigure class contains this code:

 <pre>
     private TransformContext _transformContext;
     private Rectangle2D _cachedBounds = null;
     private Shape _cachedShape = null;

     public CloudFigure (
             double x, double y,
             double width, double height ) {

         _transformContext = new TransformContext(this);
         AffineTransform at = _transformContext.getTransform();
         at.translate(x,y);
         at.scale(width/100, height/100);
         _transformContext.invalidateCache();

         ....
     }
 </pre>

 The initial shape of this figure is in fact a "cloud" shape
 that is located at (0,0) and is 100 units on each side. The
 internal transform is therefore initialized to scale this
 shape to the requested coordinates.

 <p>
 Now, because the shape of this figure is fairly expensive to
 transform, the two instance variables <b>_cachedBounds</b> and
 <b>_cachedShape</b> store the bounds and shape for the current
 transform. If you look at the source code for this class, you will see
 that these are created and remembered in getBounds() and
 getShape(). In getShape(), for example, the internally-stored
 shape needs to be transformed into "external" coordinates:

 <pre>
     public Shape getShape () {
         if (_cachedShape == null) {
             AffineTransform at = _transformContext.getTransform();
             _cachedShape = at.createTransformedShape(_shape);
         }
         return _cachedShape;
     }
 </pre>

 Whenever the transform changes, these shapes must be cleared.
 For example:

 <pre>
     public void transform (AffineTransform at) {
         repaint();
         _cachedShape = null;
         _cachedBounds = null;
         _transformContext.preConcatenate(at);
         repaint();
     }
 </pre>

 <p>
 The only other interesting thing about this class is the
 paint() method. Because paint() is called recursively down
 the tree of figures, the TransformContext class provides
 two methods that "stack" transform contexts as the tree
 is traversed. The paint() method calls push() and pop()
 before and after painting the figure's contents:

 <pre>
     public void paint (Graphics2D g) {
         _transformContext.push(g);

         ....
         // Paint the big cloud
         AlphaComposite c = AlphaComposite.getInstance(
                 AlphaComposite.SRC_OVER,0.5f);
         g.setComposite(c);
         g.setPaint(Color.magenta);
         g.fill(_shape);

         ....
         _transformContext.pop(g);
     }
 </pre>

 That's about all that's needed to use transform contexts
 in a figure.</div>
<dl>
<dt><span class="simpleTagLabel">Version:</span></dt>
<dd>$Id$</dd>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>John Reekie</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../diva/canvas/tutorial/TransformedFigureTutorial.CloudFigure.html" title="class in diva.canvas.tutorial">TransformedFigureTutorial.CloudFigure</a></span></code>
<div class="block">CloudFigure is a class that paints itself as a
 translucent "cloud."</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../diva/canvas/tutorial/TransformedFigureTutorial.html#TransformedFigureTutorial--">TransformedFigureTutorial</a></span>()</code>
<div class="block">Create a JCanvas and put it into a window.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../diva/canvas/tutorial/TransformedFigureTutorial.html#createFigures--">createFigures</a></span>()</code>
<div class="block">Create instances of the class defined
 in this file.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../diva/canvas/tutorial/TransformedFigureTutorial.html#main-java.lang.String:A-">main</a></span>(java.lang.String[]&nbsp;argv)</code>
<div class="block">Main function</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="TransformedFigureTutorial--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>TransformedFigureTutorial</h4>
<pre>public&nbsp;TransformedFigureTutorial()</pre>
<div class="block">Create a JCanvas and put it into a window.</div>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="createFigures--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createFigures</h4>
<pre>public&nbsp;void&nbsp;createFigures()</pre>
<div class="block">Create instances of the class defined
 in this file. To make the demo a little more interesting,
 make them draggable.</div>
</li>
</ul>
<a name="main-java.lang.String:A-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>main</h4>
<pre>public static&nbsp;void&nbsp;main(java.lang.String[]&nbsp;argv)</pre>
<div class="block">Main function</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../diva/canvas/tutorial/TerminalTutorial.html" title="class in diva.canvas.tutorial"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../diva/canvas/tutorial/TransformedFigureTutorial.CloudFigure.html" title="class in diva.canvas.tutorial"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?diva/canvas/tutorial/TransformedFigureTutorial.html" target="_top">Frames</a></li>
<li><a href="TransformedFigureTutorial.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
