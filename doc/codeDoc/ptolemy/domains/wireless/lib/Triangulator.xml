<?xml version="1.0" standalone="yes"?>
<!DOCTYPE doc PUBLIC "-//UC Berkeley//DTD DocML 1//EN"
    "http://ptolemy.eecs.berkeley.edu/xml/dtd/DocML_1.dtd">
<doc name="Triangulator" class="ptolemy.domains.wireless.lib.Triangulator">
  <description>
Given inputs that represent the location of a sensor and the time at&#10; which those sensors detect an event, this actor outputs the location&#10; of the source of the event.  It uses the specified&#10; &lt;i&gt;signalPropagationSpeed&lt;/i&gt; and triangulates.&#10; &lt;p&gt;&#10; The input is a record with two fields named &quot;location&quot; and &quot;time&quot;.&#10; The location field is an array of doubles, and the time is a double.&#10; In the current implementation, the actor assumes a two-dimensional space,&#10; so the location field is assumed to be an array with two doubles,&#10; which represent the horizontal (east-west) and vertical (north-south)&#10; location of the sensor.  The time field is assumed to be&#10; a double representing the time at which the event was detected by&#10; the sensor.&#10; &lt;p&gt;&#10; The triangulation algorithm requires three distinct sensor inputs&#10; for the same event in order to be able to calculate the location&#10; of the origin of the event.  Suppose that the event occurred at&#10; time &lt;i&gt;t&lt;/i&gt; and location &lt;i&gt;x&lt;/i&gt;.  Suppose that three sensors&#10; at locations &lt;i&gt;y1&lt;/i&gt;, &lt;i&gt;y2&lt;/i&gt;, and &lt;i&gt;y3&lt;/i&gt; have each detected&#10; events at times &lt;i&gt;t1&lt;/i&gt;, &lt;i&gt;t2&lt;/i&gt;, and &lt;i&gt;t3&lt;/i&gt;, respectively.&#10; Then this actor looks for a solution for &lt;i&gt;x&lt;/i&gt; and &lt;i&gt;t&lt;/i&gt;&#10; in the following equations:&#10; &lt;blockquote&gt;&#10; distance(&lt;i&gt;x&lt;/i&gt;, &lt;i&gt;y1&lt;/i&gt;)/&lt;i&gt;v&lt;/i&gt; = &lt;i&gt;t1&lt;/i&gt; - &lt;i&gt;t&lt;/i&gt;,&#10; &lt;br&gt;&#10; distance(&lt;i&gt;x&lt;/i&gt;, &lt;i&gt;y2&lt;/i&gt;)/&lt;i&gt;v&lt;/i&gt; = &lt;i&gt;t2&lt;/i&gt; - &lt;i&gt;t&lt;/i&gt;,&#10; &lt;br&gt;&#10; distance(&lt;i&gt;x&lt;/i&gt;, &lt;i&gt;y3&lt;/i&gt;)/&lt;i&gt;v&lt;/i&gt; = &lt;i&gt;t3&lt;/i&gt; - &lt;i&gt;t&lt;/i&gt;,&#10; &lt;br&gt;&#10; &lt;/blockquote&gt;&#10; where &lt;i&gt;v&lt;/i&gt; is the value of &lt;i&gt;propagationSpeed&lt;/i&gt;.&#10; If such a solution is found, then the output &lt;i&gt;x&lt;/i&gt; is produced.&#10; &lt;p&gt;&#10; Since three distinct observations are required, this actor will&#10; produce no output until it has received three distinct observations.&#10; The observations are distinct if the sensor locations are distinct.&#10; If the three observations yield no solution, then this actor&#10; will produce no output.  However, it is possible for the three&#10; observations to come from distinct events, in which case the output&#10; may be erroneous.  To guard against this, this actor provides a&#10; &lt;i&gt;timeWindow&lt;/i&gt; parameter.  The times of the three observations&#10; must be within the value of &lt;i&gt;timeWindow&lt;/i&gt;, or no output will&#10; be produced. The output is an array of doubles, which in this&#10; implementation represent the X and Y locations of the event.  </description>
  <author>Xiaojun Liu, Edward A. Lee</author>
  <version>$Id$</version>
  <since>Ptolemy II 4.0</since>
  <Pt.ProposedRating>Yellow (eal)</Pt.ProposedRating>
  <Pt.AcceptedRating>Red (ptolemy)</Pt.AcceptedRating>
    <!--ptolemy.actor.TypedIOPort-->
    <port name="input">The input port for an event detection, which is a record&#10;  containing the location of a sensor that has detected the&#10;  event and the time at which the sensor detected the event.&#10;  This has type {location = {double}, time = double} The location&#10;  is assumed to have two entries.</port>
    <!--ptolemy.actor.TypedIOPort-->
    <port name="output">The output producing the calculated event location.&#10;  This has type {double}, a double array with two entries.</port>
    <!--ptolemy.data.expr.Parameter-->
    <property name="signalPropagationSpeed">Speed of propagation of the signal to be used for triangulation.&#10;  This is a double that defaults to 344.0 (the speed of sound in&#10;  air at room temperature, in meters per second).</property>
    <!--ptolemy.data.expr.Parameter-->
    <property name="timeWindow">Time window within which observations are assumed to come from&#10;  the same sound event.&#10;  This is a double that defaults to 0.5 (in seconds).</property>
</doc>
