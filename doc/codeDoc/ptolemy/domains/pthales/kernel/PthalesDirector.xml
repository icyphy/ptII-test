<?xml version="1.0" standalone="yes"?>
<!DOCTYPE doc PUBLIC "-//UC Berkeley//DTD DocML 1//EN"
    "http://ptolemy.eecs.berkeley.edu/xml/dtd/DocML_1.dtd">
<doc name="PthalesDirector" class="ptolemy.domains.pthales.kernel.PthalesDirector">
  <description>
A director for multidimensional dataflow.&#10; &lt;p&gt;This is based on Array-OL, as described by:&lt;/p&gt;&#10; &lt;ol&gt;&#10; &lt;li&gt;&#10; Boulet, P. (2007). &quot;Array-OL Revisited, Multidimensional Intensive&#10; Signal Processing Specification,&quot; Technical Report 6113,&#10; INRIA, Orsay, France.&#10; &lt;/ol&gt;&#10;&#10; &lt;p&gt;A more detailed documentation of the Pthales domain can be found in&#10; a technical report currently under preparation and accessible at:&lt;/p&gt;&#10; &lt;ol&gt;&#10; &lt;li&gt;Remi Barrere, Eric Lenormand, Dai Bui, Edward A. Lee, Christopher Shaver and Stavros Tripakis,&#10; &quot;An Introduction to the Pthales Domain of Ptolemy II,&#10; EECS Department,&#10; University of California, Berkeley,&#10; Technical Report No. UCB/EECS-2011-32,&#10; April 26, 2011.&#10; (&lt;a href=&quot;http://www.eecs.berkeley.edu/Pubs/TechRpts/2011/EECS-2011-32.html&quot;&gt;http://www.eecs.berkeley.edu/Pubs/TechRpts/2011/EECS-2011-32.html&lt;/a&gt;)&#10; &lt;/li&gt;&#10; &lt;/ol&gt;&#10;&#10; &lt;p&gt;The notation used here is intended to follow the spirit of&#10; SpearDE [FIXME: Reference?], from Thales, a software system&#10; based on Array-OL. In this notation, unlike Boulet's,&#10; dimensions are named, and patterns for reading and writing&#10; arrays are given using those names.&lt;/p&gt;&#10; &lt;p&gt;&#10; [FIXME: the description that follows needs update, the contents and syntax of parameter specs have changed]&#10; [FIXME: it seems mostly OK to me (Stavros): I made a mild pass. Please check]&#10; The execution is governed by the following parameters&#10; in the model. In all cases except for the &quot;repetitions&quot;&#10; parameter, the parameters are OrderedRecords&#10; of the form &quot;[x = n, y = m, ...]&quot;, where x and y are arbitrary&#10; dimension names and n and m are non-negative integers.&#10; For parameters that supports strides (such as the &quot;pattern&quot; parameter),&#10; n and m can be replaced by {n,s} or {m,s}, where s is the stride&#10; (a positive integer).&#10; The stride defaults to 1 if not specified. Unless otherwise&#10; stated, the parameters do not support strides.&#10; Ports contain the following parameters:&lt;/p&gt;&#10; &lt;ol&gt;&#10;&#10; &lt;li&gt; &lt;i&gt;size&lt;/i&gt;: This is a parameter of each output port&#10; that specifies the size of the array written in that output&#10; port. All dimensions must be specified. This parameter&#10; is optional, as the size of an output array can be deduced&#10; from the other parameters. In addition, every input&#10; port of a composite actor that contains a PthalesDirector&#10; must also have such a parameter. [FIXME: true?]&lt;/li&gt;&#10;&#10; &lt;li&gt; &lt;i&gt;base&lt;/i&gt;: This mandatory parameter gives the base location&#10; (origin) of the output or input array at which an actor begins&#10; writing or reading at each iteration of this director.&#10; All dimensions must be specified. The order in which they are&#10; specified does not matter.&lt;/li&gt;&#10;&#10; &lt;li&gt; &lt;i&gt;pattern&lt;/i&gt;: This is a parameter of each port that&#10; specifies the shape of the portion of the array produced or consumed&#10; on that port at each firing of the actor within an iteration.&#10; The number of firings of an actor within an iteration is specified&#10; by the &quot;repetitions&quot; parameter of the actor (see below).&#10; Moreover, if an actor reads from or writes to the port&#10; sequentially (using get() and send() methods), then the pattern&#10; specifies the order in which the array is filled.&#10; For example, if you send tokens with values 1, 2, 3, 4, 5, 6&#10; using a pattern [x=3, y=2], then the array is filled as&#10; follows (assuming base=[x=0, y=0]):&#10; &lt;table summary=&quot;Array contents for [x=3, y=2]&quot;&gt;&#10; &lt;tr&gt; &lt;td&gt; x &lt;/td&gt; &lt;td&gt; y &lt;/td&gt; &lt;td&gt; value &lt;/td&gt;&lt;/tr&gt;&#10; &lt;tr&gt; &lt;td&gt; 0 &lt;/td&gt; &lt;td&gt; 0 &lt;/td&gt; &lt;td&gt; 1 &lt;/td&gt;&lt;/tr&gt;&#10; &lt;tr&gt; &lt;td&gt; 1 &lt;/td&gt; &lt;td&gt; 0 &lt;/td&gt; &lt;td&gt; 2 &lt;/td&gt;&lt;/tr&gt;&#10; &lt;tr&gt; &lt;td&gt; 2 &lt;/td&gt; &lt;td&gt; 0 &lt;/td&gt; &lt;td&gt; 3 &lt;/td&gt;&lt;/tr&gt;&#10; &lt;tr&gt; &lt;td&gt; 0 &lt;/td&gt; &lt;td&gt; 1 &lt;/td&gt; &lt;td&gt; 4 &lt;/td&gt;&lt;/tr&gt;&#10; &lt;tr&gt; &lt;td&gt; 1 &lt;/td&gt; &lt;td&gt; 1 &lt;/td&gt; &lt;td&gt; 5 &lt;/td&gt;&lt;/tr&gt;&#10; &lt;tr&gt; &lt;td&gt; 2 &lt;/td&gt; &lt;td&gt; 1 &lt;/td&gt; &lt;td&gt; 6 &lt;/td&gt;&lt;/tr&gt;&#10; &lt;/table&gt;&#10; If on the other hand you specify a pattern&#10; [y=2, x=3], then an array of the same shape is used,&#10; but it is now filled as follows:&#10; &lt;table summary=&quot;Array contents for [y=2, x=3]&quot;&gt;&#10; &lt;tr&gt; &lt;td&gt; x &lt;/td&gt; &lt;td&gt; y &lt;/td&gt; &lt;td&gt; value &lt;/td&gt;&lt;/tr&gt;&#10; &lt;tr&gt; &lt;td&gt; 0 &lt;/td&gt; &lt;td&gt; 0 &lt;/td&gt; &lt;td&gt; 1 &lt;/td&gt;&lt;/tr&gt;&#10; &lt;tr&gt; &lt;td&gt; 0 &lt;/td&gt; &lt;td&gt; 1 &lt;/td&gt; &lt;td&gt; 2 &lt;/td&gt;&lt;/tr&gt;&#10; &lt;tr&gt; &lt;td&gt; 1 &lt;/td&gt; &lt;td&gt; 0 &lt;/td&gt; &lt;td&gt; 3 &lt;/td&gt;&lt;/tr&gt;&#10; &lt;tr&gt; &lt;td&gt; 1 &lt;/td&gt; &lt;td&gt; 1 &lt;/td&gt; &lt;td&gt; 4 &lt;/td&gt;&lt;/tr&gt;&#10; &lt;tr&gt; &lt;td&gt; 2 &lt;/td&gt; &lt;td&gt; 0 &lt;/td&gt; &lt;td&gt; 5 &lt;/td&gt;&lt;/tr&gt;&#10; &lt;tr&gt; &lt;td&gt; 2 &lt;/td&gt; &lt;td&gt; 1 &lt;/td&gt; &lt;td&gt; 6 &lt;/td&gt;&lt;/tr&gt;&#10; &lt;/table&gt;&#10; If a stride is given, then the pattern may have gaps&#10; in it. For example, &quot;x = {2,2}&quot; specifies that two values&#10; are produced in the x dimension, and that they are separated&#10; by one value that is not produced. Values that are not&#10; produced default to zero (the value of zero depends on the&#10; data type; for example, zero for strings is the empty string,&#10; whereas zero for doubles is 0.0).&lt;/li&gt;&#10;&#10; &lt;li&gt; &lt;i&gt;tiling&lt;/i&gt;: This parameter gives the increment of the&#10; base location in each dimension for each successive firing&#10; of the actor within an iteration. This is a property of an&#10; output or an input port of an actor.&lt;/li&gt;&#10;&#10; &lt;/ol&gt;&#10;&#10; In addition, actors must contain the following parameter:&#10; &lt;ol&gt;&#10; &lt;li&gt; &lt;i&gt;repetitions&lt;/i&gt;: This is a required parameter&#10; for every actor in the Pthales domain. It is an array of&#10; positive integers of the form &quot;{ k, l, ... }&quot;. It specifies&#10; the number of times an actor fires within an iteration. This&#10; number is equal to the product of all elements in the repetitions&#10; vector. So, &quot;{2, 4}&quot; specifies that the actor should fire a total&#10; of 2*4=8 times at each iteration. Moreover, this parameter defines&#10; a set of nested loops (of depth equal to the length of the array) and&#10; the number of iterations of each loop (from the inner to the outer loop).&#10; So &quot;{2, 4}&quot; specifies an inner loop with 2 iterations and an outer loop&#10; with 4 iterations. There is a one-to-one mapping between the elements&#10; of the repetitions array and the fields of the tiling parameters of all&#10; ports of the corresponding actor. The body of the inner-most loop&#10; specifies the processing that the actor performs on a given pattern,&#10; during one firing of the actor within an iteration. A complete&#10; execution of the entire nested loop specifies the entire processing&#10; of the array by the actor. Thus, each firing of the actor produces&#10; or consumes only portions of the array and the complete processing&#10; is done by assembling these portions together according to the&#10; above parameters.&lt;/li&gt;&#10; &lt;/ol&gt;&#10; &lt;p&gt;&#10; In all cases, when indexes are incremented, they are incremented&#10; in a toroidal fashion, wrapping around when they reach the size&#10; of the array. Thus, it is always possible (though rarely useful)&#10; for an array size to be 1 in every dimension. [FIXME?]&lt;/p&gt;&#10; &lt;p&gt;&#10; NOTE: It should be possible to define a PtalesPort and&#10; PtalesCompositeActor that contain the above parameters, as&#10; a convenience. These could be put in a library.&lt;/p&gt;&#10; &lt;p&gt;&#10; NOTE: It should be possible to create a single interface&#10; for this director so that when double clicked, it&#10; brings up an interactive dialog that has the form of a Spear&#10; table. It would have one row per port, plus a header row&#10; to specify the iterations.&lt;/p&gt;&#10; &lt;p&gt;&#10; FIXME: Need to export production and consumption data for&#10; SDF, allowing these Pthales models to be nested within SDF&#10; or within Pthales, which will also allow it to be nested&#10; within modal models.&lt;/p&gt;  </description>
  <author>Edward A. Lee, Eric Lenormand, Stavros Tripakis</author>
  <version>$Id$</version>
  <since>Ptolemy II 10.0</since>
  <Pt.ProposedRating>Red (cxh)</Pt.ProposedRating>
  <Pt.AcceptedRating>Red (cxh)</Pt.AcceptedRating>
    <!--ptolemy.data.expr.StringParameter-->
    <property name="_library">Buffer memory.</property>
</doc>
