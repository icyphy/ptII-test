<?xml version="1.0" standalone="yes"?>
<!DOCTYPE doc PUBLIC "-//UC Berkeley//DTD DocML 1//EN"
    "http://ptolemy.eecs.berkeley.edu/xml/dtd/DocML_1.dtd">
<doc name="AudioWriteBuffer" class="ptolemy.actor.lib.javasound.AudioWriteBuffer">
  <description>
This actor writes audio samples to a buffer and saves the buffer&#10; to a sound file on wrapup. In each iteration, if there is a token&#10; available on the &lt;i&gt;data&lt;/i&gt; and &lt;i&gt;address&lt;/i&gt; ports, then the&#10; data DoubleToken is written to the buffer location specified by&#10; the address IntToken. The valid address range is 0 to&#10; &lt;i&gt;bufferLength&lt;/i&gt; -1. If an invalid address is specified, then&#10; the data value will be ignored and no data will be written.&#10; The audio samples in the buffer will be written to the sound file&#10; specified by the &lt;i&gt;pathName&lt;/i&gt; parameter on wrapup.&#10;&#10; &lt;p&gt;Any existing file with the same name will be silently&#10; overwritten. The data port is of type DoubleToken. Each DoubleToken&#10; read from the data port represents one sample of the audio data and&#10; should be in the range [-1.0, 1.0]. Any samples that are outside of&#10; this range will be hard-clipped to fall within this range before&#10; they are written to the sound file. Single channel (mono) audio is&#10; supported but stereo is not supported.&lt;/p&gt;&#10;&#10; &lt;p&gt;The following parameters should be set to specify the format&#10; of the file to write. In all cases, an exception is thrown if&#10; an illegal parameter value is used. Note that if a parameter is&#10; changed while audio writing is active, all data written so far will&#10; be saved, and the sound file will be closed. Subsequent audio&#10; samples will then be written to a new sound file with the new&#10; parameter values.&lt;/p&gt;&#10;&#10; &lt;ul&gt;&#10; &lt;li&gt;&lt;i&gt;pathName&lt;/i&gt; should be set to the name of the output&#10; file. Any existing file with the same name will be silently&#10; overwritten. Relative filenames are supported. The default value is&#10; &quot;outfile.wav&quot;. The audio format to use is determined by the file&#10; extension. E.g., &quot;outfile.wav&quot; will create a WAV format file.&#10; The supported file formats are AU, WAV, and, AIFF.  For example,&#10; to write samples to a Sun AU format file with the name &quot;test.au&quot;&#10; in the directory &quot;c:\tmp&quot;, this parameter should be set to the&#10; value c:\tmp\test.au. To write samples to a file with name &quot;test.au&quot;&#10; in the current directory, this parameter should be set to the value&#10; test.au.&lt;/li&gt;&#10; &lt;li&gt;&lt;i&gt;channels&lt;/i&gt; should be set to desired number of audio&#10; channels. Allowable values are 1 (for mono) and 2 (for stereo).&#10; The default value is 1. Only single-channel audio is currently&#10; supported. This limitation will be removed in a future version&#10; of this actor.&lt;/li&gt;&#10; &lt;li&gt;&lt;i&gt;sampleRate&lt;/i&gt; should be set to desired sample rate,&#10; in Hz. The DoubleTokens read in by this actor will be&#10; interpreted as having this sample rate. Allowable values are&#10; 8000, 11025, 22050, 44100, and 48000. The default value is 8000.&#10; &lt;li&gt;&lt;i&gt;bitsPerSample&lt;/i&gt; should be set to desired bit&#10; resolution. Allowable values are 8 and 16. The default value is 16.&lt;/li&gt;&#10; &lt;/ul&gt;&#10;&#10; &lt;p&gt;There are security issues involved with accessing files and&#10; audio resources in applets. By default, applets are not&#10; allowed to write files. The .java.policy file may be modified&#10; to grant applets more privileges.&lt;/p&gt;&#10;&#10; &lt;p&gt;FIXME: this should extend AudioWriter  </description>
  <author>Brian K. Vogel</author>
  <version>$Id$</version>
  <since>Ptolemy II 2.0</since>
  <Pt.ProposedRating>Red (vogel)</Pt.ProposedRating>
  <Pt.AcceptedRating>Red (vogel)</Pt.AcceptedRating>
    <!--ptolemy.actor.TypedIOPort-->
    <port name="address">The address port, which is a multiport.</port>
    <!--ptolemy.actor.TypedIOPort-->
    <port name="data">The data port, which is a multiport.</port>
    <!--ptolemy.data.expr.Parameter-->
    <property name="bufferLength">The length of the audio buffer to use. The default value&#10;  is 8000.</property>
    <!--ptolemy.data.expr.Parameter-->
    <property name="overwrite">The write mode to use. If this parameter is set to true, then&#10;  a write to a buffer element overwrites the old value in the&#10;  buffer. Otherwise, a write adds the new value to the old value&#10;  of the buffer element.</property>
    <!--ptolemy.data.expr.Parameter-->
    <property name="sampleRate">The desired sample rate to use, in Hz. Valid values&#10;  include: 8000, 11025, 22050, 44100, and 48000.&#10;  The default value of the sample rate is an IntToken equal&#10;  to 8000.&#10;  &lt;p&gt;&#10;  An exception will be thrown if an illegal value is used.</property>
    <!--ptolemy.data.expr.Parameter-->
    <property name="bitsPerSample">The desired number of bits per sample. The default value is&#10;  an IntToken equal to 16. Supported values are 8 and 16.&#10;  An exception will be thrown if an illegal value is&#10;  used.</property>
    <!--ptolemy.data.expr.Parameter-->
    <property name="channels">The number of audio channels to use. Supported values are&#10;  1 (single channel) and 2 (stereo).&#10;  The default value is an IntToken equal to 1.&#10;  An exception will be thrown if an illegal value is used.</property>
    <!--ptolemy.kernel.util.StringAttribute-->
    <property name="pathName">The name of the file to write to. The default&#10;  value of this parameter is &quot;test.wav&quot;, which creates a file called&#10;  test.wav in the current directory and writes samples to this file.&#10;  &lt;p&gt;&#10;  The audio format to use is determined by the file extension.&#10;  E.g., &quot;outfile.wav&quot; will create a WAV format file.&#10;  The supported file formats are AU, WAV, and, AIFF.&#10;  &lt;p&gt;&#10;  An exception will be occur if the path references an&#10;  unsupported sound file.</property>
</doc>
